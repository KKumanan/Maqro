(()=>{"use strict";let e=!0,t="checking";async function n(){try{if(!(await fetch("http://localhost:3000/api/events")).ok)throw new Error("Server responded with error");t="connected",document.getElementById("serverStatus").textContent="Server: Connected",document.getElementById("serverStatus").className="server-status connected"}catch(e){t="disconnected",document.getElementById("serverStatus").textContent="Server: Disconnected",document.getElementById("serverStatus").className="server-status disconnected",console.error("Server connection error:",e)}}async function c(){if("connected"===t||(await n(),"connected"===t))try{const e=await fetch("http://localhost:3000/api/events"),t=await e.json();document.getElementById("events").innerHTML="",t.events.forEach((e=>function(e){const t=document.getElementById("events"),n=document.createElement("div");var c;n.className="event",n.innerHTML=`\n    <div class="event-type">${e.event_type}</div>\n    <div class="event-time">${c=e.timestamp,new Date(c).toLocaleTimeString()}</div>\n    <div class="event-url">${e.url}</div>\n  `,t.insertBefore(n,t.firstChild)}(e)))}catch(e){console.error("Error fetching events:",e),t="disconnected",document.getElementById("serverStatus").textContent="Server: Disconnected",document.getElementById("serverStatus").className="server-status disconnected"}}async function o(){if("connected"===t||(await n(),"connected"===t))try{if(!(await fetch("http://localhost:3000/api/events",{method:"DELETE"})).ok)throw new Error("Failed to clear events");document.getElementById("events").innerHTML=""}catch(e){console.error("Error clearing events:",e),alert("Failed to clear events. Please try again.")}else alert("Cannot clear events: Server is not connected")}document.addEventListener("DOMContentLoaded",(()=>{const t=document.createElement("div");t.id="serverStatus",t.className="server-status checking",t.textContent="Server: Checking...",document.body.insertBefore(t,document.body.firstChild),document.getElementById("toggleCollection").addEventListener("click",(()=>{const t=!e;!function(t){const n=document.getElementById("status"),c=document.getElementById("toggleCollection");e=t,n.textContent=t?"Collecting events...":"Collection paused",n.className="status "+(t?"active":"inactive"),c.textContent=t?"Stop Collection":"Start Collection"}(t),chrome.tabs.query({active:!0,currentWindow:!0},(e=>{e[0].id&&chrome.tabs.sendMessage(e[0].id,{type:"TOGGLE_COLLECTION",enabled:t})}))})),document.getElementById("clearEvents").addEventListener("click",o),n(),c(),setInterval(c,5e3)}))})();
//# sourceMappingURL=popup.js.map